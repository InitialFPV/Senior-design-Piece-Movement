const float PULLEY_TEETH   = 20.0f;
const float BELT_PITCH_MM  = 2.0f;
const float STEP_ANGLE_DEG = 1.8f;
const float MICROSTEP      = 16.0f;

const float STEPS_PER_REV   = 360.0f / STEP_ANGLE_DEG;
const float DIST_PER_REV_MM = PULLEY_TEETH * BELT_PITCH_MM;
const float STEPS_PER_MM    = (STEPS_PER_REV * MICROSTEP) / DIST_PER_REV_MM;


//--------------------------------------------
// Motion State
//--------------------------------------------
struct {
    float x, y;              // current XY position (mm)
    float x_target, y_target;
    bool motion_active;
    bool position_reached;
} gantry;

struct {
    long A_pos, B_pos;        // current step counts
    long A_target, B_target;  // target step counts
} motors;

//--------------------------------------------
// Initialization
//--------------------------------------------
void setupMotion() {
    gantry.motion_active = false;
    gantry.position_reached = true;
    gantry.x = 0;
    gantry.y = 0;
    motors.A_pos = 0;
    motors.B_pos = 0;
}

constexpr float board_pos[12][8][2] = {
    {{100.000f, 100.000f}, {100.000f, 137.000f}, {100.000f, 174.000f}, {100.000f, 211.000f}, {100.000f, 248.000f}, {100.000f, 285.000f}, {100.000f, 322.000f}, {100.000f, 359.000f}},
    {{130.000f, 100.000f}, {130.000f, 137.000f}, {130.000f, 174.000f}, {130.000f, 211.000f}, {130.000f, 248.000f}, {130.000f, 285.000f}, {130.000f, 322.000f}, {130.000f, 359.000f}},
    {{175.090f, 100.000f}, {175.090f, 137.000f}, {175.090f, 174.000f}, {175.090f, 211.000f}, {175.090f, 248.000f}, {175.090f, 285.000f}, {175.090f, 322.000f}, {175.090f, 359.000f}},
    {{212.090f, 100.000f}, {212.090f, 137.000f}, {212.090f, 174.000f}, {212.090f, 211.000f}, {212.090f, 248.000f}, {212.090f, 285.000f}, {212.090f, 322.000f}, {212.090f, 359.000f}},
    {{249.090f, 100.000f}, {249.090f, 137.000f}, {249.090f, 174.000f}, {249.090f, 211.000f}, {249.090f, 248.000f}, {249.090f, 285.000f}, {249.090f, 322.000f}, {249.090f, 359.000f}},
    {{286.090f, 100.000f}, {286.090f, 137.000f}, {286.090f, 174.000f}, {286.090f, 211.000f}, {286.090f, 248.000f}, {286.090f, 285.000f}, {286.090f, 322.000f}, {286.090f, 359.000f}},
    {{323.090f, 100.000f}, {323.090f, 137.000f}, {323.090f, 174.000f}, {323.090f, 211.000f}, {323.090f, 248.000f}, {323.090f, 285.000f}, {323.090f, 322.000f}, {323.090f, 359.000f}},
    {{360.090f, 100.000f}, {360.090f, 137.000f}, {360.090f, 174.000f}, {360.090f, 211.000f}, {360.090f, 248.000f}, {360.090f, 285.000f}, {360.090f, 322.000f}, {360.090f, 359.000f}},
    {{397.090f, 100.000f}, {397.090f, 137.000f}, {397.090f, 174.000f}, {397.090f, 211.000f}, {397.090f, 248.000f}, {397.090f, 285.000f}, {397.090f, 322.000f}, {397.090f, 359.000f}},
    {{434.090f, 100.000f}, {434.090f, 137.000f}, {434.090f, 174.000f}, {434.090f, 211.000f}, {434.090f, 248.000f}, {434.090f, 285.000f}, {434.090f, 322.000f}, {434.090f, 359.000f}},
    {{479.180f, 100.000f}, {479.180f, 137.000f}, {479.180f, 174.000f}, {479.180f, 211.000f}, {479.180f, 248.000f}, {479.180f, 285.000f}, {479.180f, 322.000f}, {479.180f, 359.000f}},
    {{509.180f, 100.000f}, {509.180f, 137.000f}, {509.180f, 174.000f}, {509.180f, 211.000f}, {509.180f, 248.000f}, {509.180f, 285.000f}, {509.180f, 322.000f}, {509.180f, 359.000f}}
};